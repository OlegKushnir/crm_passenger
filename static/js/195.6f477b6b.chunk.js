"use strict";(self.webpackChunkpassenger=self.webpackChunkpassenger||[]).push([[195],{9195:function(e,r,n){n.r(r),n.d(r,{default:function(){return Z}});var s=n(4165),t=n(5861),i=n(3433),c=n(9439),d=n(2791),a=n(9140),o=n(2591),l=n(3360),u=n(2469),h=n(3575),v=n(455),x=n(1413),p=n(3855),f=n(184),j=function(e){var r=e.showNewTrip,n=e.drivers,i=e.vehicles,j=(0,h.a)().currentUser,Z=(0,d.useRef)(),m=(0,d.useRef)(),b=(0,d.useRef)(),g=(0,d.useRef)(),N=(0,d.useRef)(),w=(0,d.useState)(""),y=(0,c.Z)(w,2),T=y[0],k=y[1],C=(0,d.useState)(!1),S=(0,c.Z)(C,2),R=S[0],q=S[1],D=(0,d.useState)(""),F=(0,c.Z)(D,2),K=F[0],L=F[1],O=i.reduce((function(e,r){return r.owner===K&&e.push(r),e}),[]);function P(){return(P=(0,t.Z)((0,s.Z)().mark((function e(n){var t,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),t={creator:j.uid,driver:Z.current.value,regNum:g.current.value,from:m.current.value,to:b.current.value,passengers:N.current.value},e.prev=2,k(""),q(!0),e.next=7,(0,v.a5)(t);case 7:i=e.sent,r((0,x.Z)({uid:i},t)),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),k("Failed to add new Trip."),console.log(e.t0.message);case 15:q(!1);case 16:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}return(0,f.jsx)("div",{className:"d-flex dashboard",children:(0,f.jsxs)(a.Z,{className:"w-100 p-2",children:[(0,f.jsx)("h3",{children:"Add new Trip"}),(0,f.jsx)("p",{children:"First choose a driver to choose a vehicle."}),(0,f.jsx)(p.Z,{onSubmit:function(e){return P.apply(this,arguments)},children:(0,f.jsx)(o.Z,{striped:!0,bordered:!0,hover:!0,children:(0,f.jsx)("tbody",{children:(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{children:(0,f.jsxs)(p.Z.Control,{as:"select",id:"driver",onChange:function(e){L(e.target.value)},required:!0,ref:Z,children:[(0,f.jsx)("option",{value:"",children:"Driver"}),n.map((function(e){return(0,f.jsx)("option",{value:e.uid,children:"".concat(e.firstName," ").concat(e.lastName)},e.uid)}))]})}),(0,f.jsx)("td",{children:(0,f.jsxs)(p.Z.Control,{as:"select",id:"vehicle",required:!0,ref:g,children:[(0,f.jsx)("option",{value:"",children:"Vehicle"}),O.map((function(e){return(0,f.jsx)("option",{value:e.regNum,children:"".concat(e.brand," ").concat(e.regNum)},e.uid)}))]})}),(0,f.jsx)("td",{children:(0,f.jsxs)(p.Z.Control,{as:"select",id:"from",required:!0,ref:m,children:[(0,f.jsx)("option",{value:"",children:"From"}),(0,f.jsx)("option",{value:"Kyiv",children:"Kyiv"}),(0,f.jsx)("option",{value:"Odesa",children:"Odesa"}),(0,f.jsx)("option",{value:"Lviv",children:"Lviv"})]})}),(0,f.jsx)("td",{children:(0,f.jsxs)(p.Z.Control,{as:"select",id:"to",required:!0,ref:b,children:[(0,f.jsx)("option",{value:"",children:"To"}),(0,f.jsx)("option",{value:"Kyiv",children:"Kyiv"}),(0,f.jsx)("option",{value:"Odesa",children:"Odesa"}),(0,f.jsx)("option",{value:"Lviv",children:"Lviv"})]})}),(0,f.jsx)("td",{children:(0,f.jsx)(p.Z.Control,{type:"number",placeholder:"Passengers",required:!0,ref:N})}),(0,f.jsx)("td",{children:(0,f.jsx)(l.Z,{disabled:R,type:"submit",className:"w-100",children:"Add"})})]})})})}),T&&(0,f.jsx)(u.Z,{variant:"danger",children:T})]})})},Z=function(){var e=(0,h.a)().firestoreUser,r=(0,d.useState)([]),n=(0,c.Z)(r,2),x=n[0],p=n[1],Z=(0,d.useState)([]),m=(0,c.Z)(Z,2),b=m[0],g=m[1],N=(0,d.useState)([]),w=(0,c.Z)(N,2),y=w[0],T=w[1],k=(0,d.useState)(!1),C=(0,c.Z)(k,2),S=C[0],R=C[1];function q(){return(q=(0,t.Z)((0,s.Z)().mark((function e(r,n){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.IR)(r);case 2:(t=x).splice(n,1),p((0,i.Z)(t));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,d.useEffect)((function(){var r=function(){var r=(0,t.Z)((0,s.Z)().mark((function r(){var n,t,i;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,v.B7)();case 2:return n=r.sent,r.next=5,(0,v.jT)();case 5:return t=r.sent,r.next=8,(0,v.rE)();case 8:i=r.sent,p(n),g(t),T(i),"admin"!==(null===e||void 0===e?void 0:e.role)&&"manager"!==(null===e||void 0===e?void 0:e.role)||R(!0);case 13:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();r()})),(0,f.jsx)(a.Z,{className:"h-100",children:(0,f.jsxs)(a.Z.Body,{children:[(0,f.jsx)("h3",{children:"Trips"}),(0,f.jsx)("p",{children:"To add a trip you must have user-drivers and added vehicles."}),(0,f.jsxs)(o.Z,{striped:!0,bordered:!0,hover:!0,children:[(0,f.jsx)("thead",{children:(0,f.jsxs)("tr",{children:[(0,f.jsx)("th",{children:"Trip ID"}),(0,f.jsx)("th",{children:"Driver"}),(0,f.jsx)("th",{children:"Vehicle"}),(0,f.jsx)("th",{children:"From"}),(0,f.jsx)("th",{children:"To"}),(0,f.jsx)("th",{children:"Passengers"}),S?(0,f.jsx)("th",{}):""]})}),(0,f.jsx)("tbody",{children:null===x||void 0===x?void 0:x.map((function(e,r){var n,s,t,i=e.uid,c=e.driver,d=e.regNum,a=e.from,o=e.to,u=e.passengers;return(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{children:i}),(0,f.jsx)("td",{children:(null===(n=b.find((function(e){return e.uid===c})))||void 0===n?void 0:n.firstName)||c}),(0,f.jsxs)("td",{children:[null===(s=y.find((function(e){return e.regNum===d})))||void 0===s?void 0:s.brand," ",null===(t=y.find((function(e){return e.regNum===d})))||void 0===t?void 0:t.regNum]}),(0,f.jsx)("td",{children:a}),(0,f.jsx)("td",{children:o}),(0,f.jsx)("td",{children:u}),S?(0,f.jsx)("td",{children:(0,f.jsx)(l.Z,{onClick:function(){return function(e,r){return q.apply(this,arguments)}(i,r)},children:"Del"})}):""]},r)}))})]}),0===x.length&&(0,f.jsx)(u.Z,{variant:"info",children:"No trips yet"}),S?(0,f.jsx)(j,{showNewTrip:function(e){p([].concat((0,i.Z)(x),[e]))},drivers:b,vehicles:y}):""]})})}},2591:function(e,r,n){var s=n(1413),t=n(5987),i=n(1694),c=n.n(i),d=n(2791),a=n(162),o=n(184),l=["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"],u=d.forwardRef((function(e,r){var n=e.bsPrefix,i=e.className,d=e.striped,u=e.bordered,h=e.borderless,v=e.hover,x=e.size,p=e.variant,f=e.responsive,j=(0,t.Z)(e,l),Z=(0,a.vE)(n,"table"),m=c()(i,Z,p&&"".concat(Z,"-").concat(p),x&&"".concat(Z,"-").concat(x),d&&"".concat(Z,"-").concat("string"===typeof d?"striped-".concat(d):"striped"),u&&"".concat(Z,"-bordered"),h&&"".concat(Z,"-borderless"),v&&"".concat(Z,"-hover")),b=(0,o.jsx)("table",(0,s.Z)((0,s.Z)({},j),{},{className:m,ref:r}));if(f){var g="".concat(Z,"-responsive");return"string"===typeof f&&(g="".concat(g,"-").concat(f)),(0,o.jsx)("div",{className:g,children:b})}return b}));r.Z=u}}]);
//# sourceMappingURL=195.6f477b6b.chunk.js.map